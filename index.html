<!doctype html>
<html lang="pt-BR">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Pizzaria Demo</title>
  <link rel="stylesheet" href="css/style.css">
</head>

<body>
  <header class="site-header">
    <div class="site-header-inner">
      <span class="site-brand">
        <img class="site-brand-logo" src="assets/icons/logo.webp" alt="Pizzaria Demo">
        <span class="site-brand-text">Pizzaria Demo</span>
      </span>
      <button class="cart-button" id="cartButton" type="button" aria-controls="cartDrawer" aria-expanded="false">
        <span class="cart-icon" aria-hidden="true">🛒</span>
        <span class="cart-label">Carrinho</span>
        <span class="cart-badge" id="cartBadge">0</span>
      </button>
    </div>
  </header>
  <main class="hero hero--image">
    <div class="hero-content">
      <!-- Logo da pizzaria no hero -->
      <img class="hero-logo" src="assets/icons/logo.webp" alt="Logo da Pizzaria Demo">
      <p class="hero-kicker" id="hero-kicker">Pizzas artesanais em minutos</p>
      <h1 class="hero-title" id="hero-title">A pizza perfeita, quentinha e na sua porta hoje.</h1>
      <p class="hero-subtitle" id="hero-subtitle">Escolha seu sabor e finalize o pedido em menos de 1 minuto.</p>
      <a class="hero-cta" id="hero-cta" href="https://wa.me/5511999999999">Pedir no WhatsApp</a>
    </div>
  </main>
  <section class="benefits">
    <div class="benefits-inner">
      <header class="benefits-header">
        <h2 class="benefits-title" id="benefits-title">Por que pedir com a gente?</h2>
        <p class="benefits-subtitle" id="benefits-subtitle">Três motivos que fazem seu pedido chegar melhor e mais rápido.</p>
      </header>
      <div class="benefits-grid">
        <article class="benefit-card" data-benefit="0">
          <span class="benefit-icon" aria-hidden="true">🔥</span>
          <h3 class="benefit-title">Sai do forno, vai pra você</h3>
          <p class="benefit-text">Assamos na hora e entregamos em embalagem térmica.</p>
        </article>
        <article class="benefit-card" data-benefit="1">
          <span class="benefit-icon" aria-hidden="true">⏱️</span>
          <h3 class="benefit-title">Entrega rápida na sua região</h3>
          <p class="benefit-text">Rotas otimizadas para chegar em até 30 minutos.</p>
        </article>
        <article class="benefit-card" data-benefit="2">
          <span class="benefit-icon" aria-hidden="true">🥗</span>
          <h3 class="benefit-title">Ingredientes selecionados</h3>
          <p class="benefit-text">Massa leve, molho artesanal e sabores equilibrados.</p>
        </article>
      </div>
    </div>
  </section>

 
  
  <section class="catalog">
    <div class="catalog-inner">
      <header class="catalog-header">
        <h2 class="catalog-title">Nosso cardápio</h2>
        <p class="catalog-subtitle">Escolha sua combinação favorita e peça agora.</p>
      </header>
      <div class="catalog-grid">
        <a class="catalog-card" href="catalogo/pizzas.html">
          <span class="catalog-icon" aria-hidden="true">🍕</span>
          <h3 class="catalog-card-title">Pizzas</h3>
          <p class="catalog-card-text">Clássicas e especiais com massa artesanal.</p>
        </a>
        <a class="catalog-card" href="catalogo/lanches.html">
          <span class="catalog-icon" aria-hidden="true">🍔</span>
          <h3 class="catalog-card-title">Lanches</h3>
          <p class="catalog-card-text">Combos completos para matar a fome.</p>
        </a>
        <a class="catalog-card" href="catalogo/bebidas.html">
          <span class="catalog-icon" aria-hidden="true">🥤</span>
          <h3 class="catalog-card-title">Bebidas</h3>
          <p class="catalog-card-text">Refrigerantes, sucos e águas geladas.</p>
        </a>
      </div>
    </div>
  </section>

   <section class="features">
    <div class="features-inner">
      <header class="features-header">
        <h2 class="features-title">Momentos especiais na nossa pizzaria</h2>
        <p class="features-subtitle">Ambientes pensados para família, celebrações e encontros inesquecíveis.</p>
      </header>
      <div class="features-grid">
        <a class="feature-card" href="espaco_kids/index.html">
          <span class="feature-icon" aria-hidden="true">🧸</span>
          <h3 class="feature-title">Espaço Kids e Ambiente Acolhedor</h3>
          <p class="feature-text">Ambiente familiar, confortável e com espaço kids para garantir tranquilidade aos pais e diversão para os pequenos durante a refeição. Ideal para momentos em grupo.</p>
        </a>
        <a class="feature-card" href="faca_sua_festa/index.html">
          <span class="feature-icon" aria-hidden="true">🎉</span>
          <h3 class="feature-title">Faça sua Festa Aqui</h3>
          <p class="feature-text">Estrutura completa para aniversários, confraternizações e eventos especiais. A pizzaria oferece espaço, cardápio personalizado e atendimento dedicado para tornar sua comemoração inesquecível.</p>
        </a>
      </div>
    </div>
  </section>

  
  <section class="app-showcase">
    <div class="app-showcase-inner">
      <div class="app-showcase-content">
        <h2 class="app-showcase-title" id="app-title">Seu pedido em um toque</h2>
        <p class="app-showcase-text" id="app-text">Um app pensado para pedir rápido, repetir favoritos e acompanhar a entrega em tempo real.</p>
        <button class="app-download" type="button" disabled>Download App</button>
      </div>
      <img class="app-showcase-image" src="assets/app-mockup.webp" alt="Mockup do app de pizzaria em um smartphone">
    </div>
  </section>
  <section class="social-proof">
    <div class="social-proof-inner">
      <p class="social-proof-highlight" id="social-highlight">Mais de 2.000 clientes satisfeitos na última semana.</p>
      <div class="social-proof-stars" id="social-stars" aria-label="Avaliação cinco estrelas">⭐⭐⭐⭐⭐</div>
      <p class="social-proof-trust" id="social-trust">Confiança, sabor e entrega rápida em cada pedido.</p>
    </div>
  </section>
  <section class="cta-final">
    <div class="cta-final-inner">
      <h2 class="cta-final-title" id="cta-title">Ficou com fome? Peça agora e receba quentinha.</h2>
      <div class="snack-divider snack-divider--cta" aria-hidden="true">
        <span class="snack">🍟</span>
        <span class="snack">🍕</span>
        <span class="snack">🥤</span>
      </div>
      <p class="cta-final-text" id="cta-text">Clique no botão e finalize seu pedido em instantes.</p>
      <a class="cta-final-button" id="cta-button" href="https://wa.me/5511999999999">Chamar no WhatsApp</a>
    </div>
  </section>

  <div class="cart-overlay" id="cartOverlay" hidden></div>
  <aside class="cart-drawer" id="cartDrawer" aria-hidden="true">
    <header class="cart-header">
      <h2>Carrinho</h2>
      <button class="cart-close" id="cartClose" type="button">Fechar</button>
    </header>
    <div class="cart-content">
      <div class="cart-empty" id="cartEmpty">Seu carrinho está vazio.</div>
      <div class="cart-items" id="cartItems"></div>
    </div>
    <footer class="cart-footer">
      <div class="cart-total-row">
        <span>Total</span>
        <strong id="cartTotal">R$ 0,00</strong>
      </div>
      <button class="cart-checkout" id="cartCheckout" type="button">Finalizar pedido</button>
    </footer>
  </aside>
  <!-- Chat widget (HTML + CSS + JS) -->
  <div id="pizza-chat-widget" role="region" aria-label="Chat da Pizzaria">
    <!-- Header -->
    <div id="pcw-header">
      <span>Pizzaria Chat</span>
      <button id="pcw-close" type="button" aria-label="Fechar chat">×</button>
    </div>

    <!-- Lista de mensagens -->
    <div id="pcw-messages" aria-live="polite"></div>

    <!-- Input + botão -->
    <div id="pcw-input-row">
      <input
        id="pcw-input"
        type="text"
        placeholder="Digite sua mensagem..."
        autocomplete="off"
      />
      <button id="pcw-send" type="button">Enviar</button>
    </div>
  </div>

  <style>
    /* Estilo mínimo do widget */
    #pizza-chat-widget {
      position: fixed;
      right: 16px;
      bottom: 16px;
      width: 320px;
      max-height: 420px;
      display: flex;
      flex-direction: column;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: 0 12px 30px rgba(0, 0, 0, 0.2);
      background: #fff8f2;
      font-family: Arial, sans-serif;
      z-index: 9999;
    }

    #pcw-header {
      background: #c0392b;
      color: #fff;
      padding: 12px 14px;
      font-weight: bold;
      display: flex;
      align-items: center;
      justify-content: space-between;
      gap: 12px;
    }

    #pcw-messages {
      padding: 12px;
      overflow-y: auto;
      flex: 1;
      gap: 8px;
      display: flex;
      flex-direction: column;
    }

    .pcw-msg {
      max-width: 85%;
      padding: 8px 10px;
      border-radius: 10px;
      line-height: 1.3;
      font-size: 14px;
      word-break: break-word;
    }

    .pcw-msg.user {
      align-self: flex-end;
      background: #fde1d7;
      color: #333;
    }

    .pcw-msg.assistant {
      align-self: flex-start;
      background: #fff;
      color: #333;
      border: 1px solid #f2c8b8;
    }

    .pcw-whatsapp {
      align-self: flex-start;
      margin-top: 4px;
    }

    .pcw-whatsapp a {
      display: inline-block;
      background: #25d366;
      color: #fff;
      text-decoration: none;
      padding: 8px 10px;
      border-radius: 8px;
      font-size: 13px;
    }

    #pcw-input-row {
      display: flex;
      gap: 8px;
      padding: 10px;
      background: #fff;
      border-top: 1px solid #f2c8b8;
    }

    #pcw-input {
      flex: 1;
      padding: 8px 10px;
      border-radius: 8px;
      border: 1px solid #e0b6a7;
      outline: none;
    }

    #pcw-send {
      background: #c0392b;
      color: white;
      border: none;
      border-radius: 8px;
      padding: 8px 12px;
      cursor: pointer;
    }

    #pcw-send:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
  </style>

  <script>
    // Configure aqui o restaurante para reuso em outros clientes
    const RESTAURANT_ID = "pizzaria_napoli";
    // Endpoint do backend local (troque em producao)
    const CHAT_ENDPOINT = `https://assistant-restaurant.onrender.com/restaurant/${RESTAURANT_ID}/chat`;

    // State do assistente (mantem o contexto da conversa)
    let state = {};

    // Historico local da conversa (somente no frontend)
    const history = [];

    // Elementos do DOM
    const messagesEl = document.getElementById("pcw-messages");
    const inputEl = document.getElementById("pcw-input");
    const sendBtn = document.getElementById("pcw-send");
    const closeBtn = document.getElementById("pcw-close");

    // Adiciona uma mensagem no painel
    function addMessage(sender, text) {
      const msg = document.createElement("div");
      msg.className = `pcw-msg ${sender}`;
      msg.textContent = text;
      messagesEl.appendChild(msg);

      history.push({ sender, text });
      scrollToBottom();
    }

    // Adiciona botao do WhatsApp, se vier na resposta
    function addWhatsAppButton(link) {
      const wrap = document.createElement("div");
      wrap.className = "pcw-whatsapp";

      const a = document.createElement("a");
      a.href = link;
      a.target = "_blank";
      a.rel = "noopener noreferrer";
      a.textContent = "Falar no WhatsApp";

      wrap.appendChild(a);
      messagesEl.appendChild(wrap);
      scrollToBottom();
    }

    // Mantem o scroll no final da conversa
    function scrollToBottom() {
      messagesEl.scrollTop = messagesEl.scrollHeight;
    }

    // Envia mensagem para o backend
    async function sendMessage() {
      const text = inputEl.value.trim();
      if (!text) return;

      addMessage("user", text);
      inputEl.value = "";
      inputEl.focus();

      sendBtn.disabled = true;

      try {
        const response = await fetch(CHAT_ENDPOINT, {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: text, state }),
        });

        if (!response.ok) {
          throw new Error(`HTTP ${response.status}`);
        }

        const data = await response.json();

        // Atualiza o state do assistente
        if (data && data.state !== undefined) {
          state = data.state;
        }

        // Renderiza a resposta do assistente
        const assistantText =
          data.response || data.message || data.reply || "Ok! Posso ajudar em mais algo?";
        addMessage("assistant", assistantText);

        // Se vier link do WhatsApp, mostra o botao
        if (data && data.whatsapp_link) {
          addWhatsAppButton(data.whatsapp_link);
        }
      } catch (err) {
        console.error("Erro no chat:", err);
        addMessage("assistant", "Erro ao conectar com o chat. Tente novamente em instantes.");
      } finally {
        sendBtn.disabled = false;
      }
    }

    // Eventos de envio
    sendBtn.addEventListener("click", sendMessage);
    inputEl.addEventListener("keydown", (e) => {
      if (e.key === "Enter") {
        e.preventDefault();
        sendMessage();
      }
    });

    // Fecha o widget (pode recarregar a pagina para reabrir)
    closeBtn.addEventListener("click", () => {
      const widget = document.getElementById("pizza-chat-widget");
      if (widget) widget.style.display = "none";
    });

    // Mensagem inicial opcional
    addMessage("assistant", "Ola! Posso ajudar com seu pedido?");
  </script>
  <script src="js/script.js"></script>
</body>

</html>
    #pcw-close {
      background: transparent;
      color: #fff;
      border: none;
      font-size: 18px;
      line-height: 1;
      cursor: pointer;
      padding: 0 4px;
    }

    #pcw-close:hover {
      opacity: 0.85;
    }
